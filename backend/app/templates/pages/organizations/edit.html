{% extends "base.html" %}

{% block title %}{{ page_title }}{% endblock %}

{% block content %}
<div class="container mx-auto px-4 py-8 max-w-4xl">
    <!-- Header -->
    <div class="mb-8">
        <div class="flex items-center mb-4">
            <a href="/app/admin/organization/{{ organization.id }}" class="text-blue-600 hover:text-blue-700 mr-4">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
                </svg>
            </a>
            <h1 class="text-3xl font-bold text-gray-900">Edit Organization</h1>
        </div>
        <p class="text-gray-600">Update your organization information and settings.</p>
    </div>

    <!-- Error Message -->
    {% if error %}
    <div class="bg-red-50 border border-red-200 rounded-md p-4 mb-6">
        <div class="flex">
            <div class="flex-shrink-0">
                <svg class="h-5 w-5 text-red-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                </svg>
            </div>
            <div class="ml-3">
                <p class="text-sm text-red-700">{{ error }}</p>
            </div>
        </div>
    </div>
    {% endif %}

    <!-- Organization Form -->
    <form action="/app/admin/organization/{{ organization.id }}/edit" method="post" class="space-y-8">
        <input type="hidden" name="csrf_token" value="{{ csrf_token() if csrf_token else '' }}">
        
        <!-- Basic Information -->
        <div class="bg-white rounded-lg shadow border border-gray-200 p-6">
            <h3 class="text-lg font-semibold text-gray-900 mb-6">Basic Information</h3>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="md:col-span-2">
                    <label for="name" class="block text-sm font-medium text-gray-700 mb-2">
                        Organization Name <span class="text-red-500">*</span>
                    </label>
                    <input type="text" 
                           id="name" 
                           name="name" 
                           value="{{ form_data.name if form_data else organization.name }}"
                           required
                           class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                    <p class="mt-1 text-sm text-gray-500">The display name for your organization</p>
                </div>
                
                <div class="md:col-span-2">
                    <label for="description" class="block text-sm font-medium text-gray-700 mb-2">Description</label>
                    <textarea id="description" 
                              name="description" 
                              rows="3"
                              class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">{{ form_data.description if form_data else organization.description }}</textarea>
                    <p class="mt-1 text-sm text-gray-500">Brief description of your organization</p>
                </div>
                
                <div>
                    <label for="organization_type" class="block text-sm font-medium text-gray-700 mb-2">Organization Type</label>
                    <select id="organization_type" 
                            name="organization_type"
                            class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                        {% set current_type = form_data.organization_type if form_data else (organization.properties.organization_type if organization.properties else 'small_business') %}
                        <option value="small_business" {% if current_type == 'small_business' %}selected{% endif %}>Small Business</option>
                        <option value="enterprise" {% if current_type == 'enterprise' %}selected{% endif %}>Enterprise</option>
                        <option value="academic" {% if current_type == 'academic' %}selected{% endif %}>Academic Institution</option>
                        <option value="research" {% if current_type == 'research' %}selected{% endif %}>Research Organization</option>
                        <option value="government" {% if current_type == 'government' %}selected{% endif %}>Government</option>
                        <option value="nonprofit" {% if current_type == 'nonprofit' %}selected{% endif %}>Non-Profit</option>
                    </select>
                </div>
                
                <div>
                    <label for="website" class="block text-sm font-medium text-gray-700 mb-2">Website</label>
                    <input type="url" 
                           id="website" 
                           name="website" 
                           value="{{ form_data.website if form_data else (organization.properties.website if organization.properties else '') }}"
                           placeholder="https://example.com"
                           class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                </div>
            </div>
        </div>

        <!-- Contact Information -->
        <div class="bg-white rounded-lg shadow border border-gray-200 p-6">
            <h3 class="text-lg font-semibold text-gray-900 mb-6">Contact Information</h3>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                    <label for="contact_email" class="block text-sm font-medium text-gray-700 mb-2">Contact Email</label>
                    <input type="email" 
                           id="contact_email" 
                           name="contact_email" 
                           value="{{ form_data.contact_email if form_data else (organization.properties.contact_email if organization.properties else '') }}"
                           class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                </div>
                
                <div>
                    <label for="contact_phone" class="block text-sm font-medium text-gray-700 mb-2">Contact Phone</label>
                    <input type="tel" 
                           id="contact_phone" 
                           name="contact_phone" 
                           value="{{ form_data.contact_phone if form_data else (organization.properties.contact_phone if organization.properties else '') }}"
                           class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                </div>
            </div>
        </div>

        <!-- Address Information -->
        <div class="bg-white rounded-lg shadow border border-gray-200 p-6">
            <h3 class="text-lg font-semibold text-gray-900 mb-6">Address</h3>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="md:col-span-2">
                    <label for="address" class="block text-sm font-medium text-gray-700 mb-2">Street Address</label>
                    <input type="text" 
                           id="address" 
                           name="address" 
                           value="{{ form_data.address if form_data else (organization.properties.address if organization.properties else '') }}"
                           class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                </div>
                
                <div>
                    <label for="city" class="block text-sm font-medium text-gray-700 mb-2">City</label>
                    <input type="text" 
                           id="city" 
                           name="city" 
                           value="{{ form_data.city if form_data else (organization.properties.city if organization.properties else '') }}"
                           class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                </div>
                
                <div>
                    <label for="state" class="block text-sm font-medium text-gray-700 mb-2">State/Province</label>
                    <input type="text" 
                           id="state" 
                           name="state" 
                           value="{{ form_data.state if form_data else (organization.properties.state if organization.properties else '') }}"
                           class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                </div>
                
                <div>
                    <label for="country" class="block text-sm font-medium text-gray-700 mb-2">Country</label>
                    <input type="text" 
                           id="country" 
                           name="country" 
                           value="{{ form_data.country if form_data else (organization.properties.country if organization.properties else '') }}"
                           class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                </div>
                
                <div>
                    <label for="postal_code" class="block text-sm font-medium text-gray-700 mb-2">Postal Code</label>
                    <input type="text" 
                           id="postal_code" 
                           name="postal_code" 
                           value="{{ form_data.postal_code if form_data else (organization.properties.postal_code if organization.properties else '') }}"
                           class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                </div>
            </div>
        </div>

        <!-- Settings -->
        <div class="bg-white rounded-lg shadow border border-gray-200 p-6">
            <h3 class="text-lg font-semibold text-gray-900 mb-6">Settings</h3>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                    <label for="timezone" class="block text-sm font-medium text-gray-700 mb-2">Timezone</label>
                    <select id="timezone" 
                            name="timezone"
                            class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                        {% set current_timezone = form_data.timezone if form_data else (organization.properties.timezone if organization.properties else 'UTC') %}
                        <option value="UTC" {% if current_timezone == 'UTC' %}selected{% endif %}>UTC</option>
                        <option value="America/New_York" {% if current_timezone == 'America/New_York' %}selected{% endif %}>Eastern Time</option>
                        <option value="America/Chicago" {% if current_timezone == 'America/Chicago' %}selected{% endif %}>Central Time</option>
                        <option value="America/Denver" {% if current_timezone == 'America/Denver' %}selected{% endif %}>Mountain Time</option>
                        <option value="America/Los_Angeles" {% if current_timezone == 'America/Los_Angeles' %}selected{% endif %}>Pacific Time</option>
                        <option value="Europe/London" {% if current_timezone == 'Europe/London' %}selected{% endif %}>London</option>
                        <option value="Europe/Paris" {% if current_timezone == 'Europe/Paris' %}selected{% endif %}>Paris</option>
                        <option value="Asia/Tokyo" {% if current_timezone == 'Asia/Tokyo' %}selected{% endif %}>Tokyo</option>
                        <option value="Australia/Sydney" {% if current_timezone == 'Australia/Sydney' %}selected{% endif %}>Sydney</option>
                    </select>
                </div>
            </div>
        </div>

        <!-- Form Actions -->
        <div class="flex justify-end space-x-4 mt-8 pt-6 border-t border-gray-200">
            <a href="/app/admin/organization/{{ organization.id }}" 
               class="px-4 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md font-medium transition-colors">
                Cancel
            </a>
            <button type="submit" 
                    class="px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-md transition-colors">
                Update Organization
            </button>
        </div>
    </form>
</div>
{% endblock %} 